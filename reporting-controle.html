<!-- reporting-controle.html -->
<!DOCTYPE html><html lang="nl"><head>…</head><body>
<div class="app-container">
  <nav class="sidebar">
    <button data-form="T01.01">T 01.01 – Subsidiaries</button>
    <button data-form="T01.02">T 01.02 – Loans granted</button>
    <!-- enz. -->
  </nav>

  <main class="content">
    <iframe id="formFrame" src=""></iframe>

    <div class="validation-area">
      <button id="btnValidate">Valideer</button>
      <div id="validationReport" style="display:none"></div>
    </div>
  </main>
</div>

<script>
  const sidebar = document.querySelector('.sidebar');
  const iframe  = document.getElementById('formFrame');
  const btnVal  = document.getElementById('btnValidate');
  const report  = document.getElementById('validationReport');

  // 1) click sidebar → laad juiste form in iframe
  sidebar.addEventListener('click', e => {
    if (!e.target.dataset.form) return;
    const key = e.target.dataset.form;
    iframe.src = `reporting-${key.toLowerCase().replace('.', '')}.html`;
    // toon validate-knop en verberg vorig rapport
    btnVal.style.display   = 'inline-block';
    report.style.display   = 'none';
    sidebar.querySelectorAll('button').forEach(b=>b.classList.remove('active'));
    e.target.classList.add('active');
  });

  // 2) Valideer-knop
  btnVal.addEventListener('click', () => {
    // roep in de iframe de runValidation aan, bijv. via postMessage
    iframe.contentWindow.postMessage('validate', '*');
  });

  // 3) Ontvang validatieresultaat vanuit iframe
  window.addEventListener('message', evt => {
    if (evt.data.type === 'validationResult') {
      const { html } = evt.data;       // HTML rapport dat je from runValidation bouwt
      report.innerHTML = html;
      report.style.display = 'block';
    }
  });

  // bij laden: trigger eerste form
  sidebar.querySelector('button').click();
</script>
</body></html>

<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Mijn DNB - Rapportage</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <style>
    body { margin:0; font-family:Arial,sans-serif; background:#f9f9fb; }
    header { background:white; border-bottom:1px solid #ddd; padding:15px 30px; display:flex; justify-content:space-between; align-items:center; }
    header img { height:30px; }
    header nav span { margin-left:20px; font-size:0.9em; color:#333; }

    .app-container { display:flex; height:calc(100vh - 60px); position:relative; }

    /* Sidebar */
    .sidebar { width:260px; background:white; border-right:1px solid #ddd; padding:20px; overflow-y:auto; transition:width .3s; }
    .sidebar.hidden { width:0; padding:0; border:none; }
    .sidebar h2 { font-size:1.1em; color:#004080; margin-bottom:20px; }
    .sidebar button { width:100%; background:none; border:none; color:#004080; text-align:left; padding:10px; cursor:pointer; border-radius:4px; margin-bottom:4px; }
    .sidebar button.active, .sidebar button:hover { background:#e6f4ff; }

    /* Toggle */
    #toggleBtn { position:absolute; top:20px; left:260px; width:20px; height:40px; background:#004080; color:#fff; border:none; border-radius:0 4px 4px 0; cursor:pointer; transition:left .3s; }
    .sidebar.hidden ~ #toggleBtn { left:0; }

    /* Content */
    .content { flex:1; padding:30px; overflow-y:auto; }

    /* start-view cards */
    .options { display:flex; gap:20px; flex-wrap:wrap; }
    .card { background:#fff; border:1px solid #ddd; border-radius:6px; width:280px; padding:20px; box-shadow:0 2px 6px rgba(0,0,0,0.05); text-align:center; }
    .card h3 { margin-top:0; color:#002d9c; }
    .card p { font-size:0.9em; color:#555; }
    .card input { display:none; }
    .card button { margin-top:15px; background:#002d9c; color:#fff; border:none; padding:8px 16px; border-radius:4px; cursor:pointer; }
    .card button:disabled { background:#aaa; cursor:not-allowed; }

    /* hide views by default */
    .view { display:none; }
    .view.active { display:block; }

    iframe { width:100%; height:80vh; border:none; background:#fff; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.05); }
  </style>
</head>
<body>

  <header>
    <img src="De_Nederlandsche_Bank_logo.svg.png" alt="DNB banner">
    <nav>
      <span>My services</span>
      <span>Support & contact</span>
      <span>EH Tom Jansen, 90004485 (kvk)</span>
      <span>ðŸ”” Notifications</span>
      <span>ðŸ‘¤</span>
    </nav>
  </header>

  <div class="app-container">
    <div class="sidebar hidden" id="sidebar">
      <h2>Formulieren</h2>
      <button onclick="loadForm('reporting-t01-01.html', this)">T 01.01 - Subsidiaries</button>
      <button onclick="loadForm('reporting-t01-02.html', this)">T 01.02 - Loans granted</button>
      <button onclick="loadForm('reporting-t01-03.html', this)">T 01.03 - Securities held</button>
      <button onclick="loadForm('reporting-t01-04.html', this)">T 01.04 - Derivative assets</button>
      <button onclick="loadForm('reporting-t02-01.html', this)">T 02.01 - Shareholders equity</button>
      <button onclick="loadForm('reporting-t02-02.html', this)">T 02.02 - Loans received</button>
      <button onclick="loadForm('reporting-t02-03.html', this)">T 02.03 - Securities issued</button>
      <button onclick="loadForm('reporting-t02-04.html', this)">T 02.04 - Derivative liabilities</button>
      <button onclick="loadForm('reporting-t03-01.html', this)">T 03.01 - Balance sheet total</button>
      <button onclick="loadForm('reporting-t04-01.html', this)">T 04.01 - International trade royalties</button>
      <button onclick="loadForm('reporting-t05-01.html', this)">T 05.01 - Totals CFI Benchmark</button>
    </div>
    <button id="toggleBtn" onclick="toggleSidebar()">â—‚</button>

    <div class="content">
      <!-- VIEW 1: Start -->
      <div id="view-start" class="view active">
        <h2>Kies een startmethode</h2>
        <div class="options">
          <div class="card" id="card-excel">
            <h3>Upload Excel-template</h3>
            <p>Gebruik uw ingevulde Excel-template. Deze wordt automatisch ingeladen.</p>
            <input type="file" id="excelUpload" accept=".xlsx,.xls">
            <button id="btnExcel" disabled>Excel kiezenâ€¦</button>
          </div>
          <div class="card" id="card-xbrl">
            <h3>Upload XBRL-rapportage</h3>
            <p>Upload uw XBRL-file. Deze wordt verwerkt in de formulieren.</p>
            <input type="file" id="xbrlUpload" accept=".xbrl,.xml">
            <button id="btnXBRL" disabled>XBRL kiezenâ€¦</button>
          </div>
          <div class="card" id="card-blank">
            <h3>Start lege rapportage</h3>
            <p>Geen bestand? U kunt het formulier ook helemaal zelf invullen.</p>
            <button id="btnBlank">Leeg formulier</button>
          </div>
        </div>
      </div>

      <!-- VIEW 2 & 3 share the iframe; we only show when unlocked -->
      <div id="view-form" class="view">
        <iframe id="formFrame" src=""></iframe>
      </div>
    </div>
  </div>

  <script>
    // sidebar toggle
    function toggleSidebar(){
      const sb=document.getElementById('sidebar'),
            btn=document.getElementById('toggleBtn');
      sb.classList.toggle('hidden');
      btn.innerHTML = sb.classList.contains('hidden') ? 'â–¸' : 'â—‚';
    }

    // navigation helper
    function loadForm(page, btn){
      document.getElementById('formFrame').src = page;
      // highlight
      document.querySelectorAll('.sidebar button').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      // show form view
      showView('form');
    }

    function showView(name){
      document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
      document.getElementById('view-'+name).classList.add('active');
      // show sidebar once we leave start
      if(name!=='start') document.getElementById('sidebar').classList.remove('hidden');
    }

    // Start-view logic
    const excelInput = document.getElementById('excelUpload'),
          btnExcel   = document.getElementById('btnExcel'),
          xbrlInput  = document.getElementById('xbrlUpload'),
          btnXBRL    = document.getElementById('btnXBRL'),
          btnBlank   = document.getElementById('btnBlank');

    // Excel
    excelInput.addEventListener('change',()=> btnExcel.disabled = !excelInput.files.length );
    document.getElementById('card-excel').addEventListener('click',()=> excelInput.click());
    btnExcel.addEventListener('click',()=>{
      const r=new FileReader(), file=excelInput.files[0];
      r.onload=e=>{
        const wb=XLSX.read(new Uint8Array(e.target.result),{type:'array'});
        wb.SheetNames.forEach(name=>{
          const arr=XLSX.utils.sheet_to_json(wb.Sheets[name],{header:1});
          localStorage.setItem(name, JSON.stringify(arr));
        });
        showView('form');
      };
      r.readAsArrayBuffer(file);
    });

    // XBRL
    xbrlInput.addEventListener('change',()=> btnXBRL.disabled = !xbrlInput.files.length );
    document.getElementById('card-xbrl').addEventListener('click',()=> xbrlInput.click());
    btnXBRL.addEventListener('click',()=>{
      const r=new FileReader(), file=xbrlInput.files[0];
      r.onload=e=>{
        localStorage.setItem('XBRL', e.target.result);
        showView('form');
      };
      r.readAsText(file);
    });

    // Blank
    btnBlank.addEventListener('click',()=> showView('form'));
  </script>

</body>
</html>
